{% extends 'layout.html' %}

{% block css %}
<link rel="stylesheet" href="{{ url_for('static',filename='styles/log_events.css') }}" type="text/css">
{% endblock %}

{% block body_tab %}

{% from "includes/_formhelpers.html" import render_field %}


<div class="container-fluid" id="form-container">
  <br /> <br /> <br /> <br />
  <span><h3>App Runs  </h3> (showing {{line_limit}} rows) <button class="btn btn-primary" id="show_filter">Show Filter</button></span>

    <form method="POST" action="" id="filter_form">
      <div class="row">
        <div class="col-xs-12 col-sm-3 form-group">
          <label for="line_limit">Row Limit:</label><br />
          <div class="flex">
            {{render_field(form1.line_limit, class_="form-control")}}
          </div>
        </div>
        <div class="col-xs-12 col-sm-3 form-group">
          <label for="timestamp_operator">Timestamp:</label><br />
          <div class="flex">
            {{render_field(form1.timestamp_operator, class_="form-control operator")}}
            {{render_field(form1.timestamp_filter, class_="form-control field_width clear-field")}}
          </div>
        </div>
        <div class="col-xs-12 col-sm-3 form-group">
          <label for="app_version_filter">App Version:</label><br />
          <div class="flex">
            {{render_field(form1.app_version_filter, class_="form-control clear-field")}}
          </div>
        </div>
        <div class="col-xs-12 col-sm-3 form-group">
          <label for="platform_filter">Platform:</label><br />
          <div class="flex">
            {{render_field(form1.platform_filter, class_="form-control clear-field")}}
          </div>
        </div>
      </div>
      <div class="filter-button-group">
        <button class="btn btn-primary filter-buttons" id="clear">Clear</button>
        <button type="submit" value="Filter" class="btn btn-primary filter-buttons">Filter</button>
      </div>
    </form>

</div>

<div class="container-fluid">

  <table class="table table-hover table-condensed table-responsive">
          <thead>
            <tr>
              <th>ID</th>
              <th><div class="timestamp-table" >Timestamp</div></th>
              <th>App version</th>
              <th>Platform</th>
              <th>Machine fingerprint</th>
              <th>Machine name</th>
            </tr>
          </thead>
          <tbody>
            {% for row,timestamp in rows1 %}

            <tr>
              <td>{{row.id}}</td>
              <td><div class="timestamp-table" >{{timestamp}}</div></td>
              <td>{{row.app_version}}</td>
              <td>{{row.platform}}</td>
              <td>{{row.machine_fingerprint}}</td>
              <td>{{row.machine_name}}</td>
            </tr>
            {% endfor %}
          </tbody>
  </table>
</div>

{% endblock %}


{% block js %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.3.1/vue.min.js"></script>
<script>
$(function(){
  $("#show_filter").click(function() {
    if ($.trim($(this).text()) === 'Show Filter') {
      $(this).text('Hide Filter');
    } else {
        $(this).text('Show Filter');
    }
    $("#filter_form").toggle();
  });

  $("#clear").click(function() {
    $(".clear-field").val("");
  });

})
</script>
{% endblock %}
